spec:
  versions:
    - name: v1alpha1
      schema:
        openAPIV3Schema:
          description: |
            Интерфейс управления Volume Group'ами и Thin pool'ами на узлах.
            
            > Этот тип ресурсов может быть создан как самим пользователем, так и контроллером `sds-node-configurator`. Контроллер `sds-node-configurator` автоматически создаст ресурс LVMVolumeGroup в случае, если найдет на узле существующую Volume Group со специальным тегом 'storage.deckhouse.io/enabled=true', при этом контроллер самостоятельно заполнит как `spec`, так и `status` поля.
            > Поле `spec.thinPools` нужно заполнить самостоятельно.
          properties:
            spec:
              properties:
                type:
                  description: |
                    Тип группы томов.
                    
                    Возможные значения:
                    
                    - `Local` — локальная группа томов; используемые устройства не являются распределёнными (не Shared LUN).
                local:
                  description: |
                    Желаемая конфигурация для локальной группы томов.
                  properties:
                    nodeName:
                      description: |
                        Желаемый узел для группы томов LVM.
                        
                        > Это поле неизменяемое.
                blockDeviceSelector:
                  description: |
                    Желаемый селектор блочных устройств.

                    > Обратите внимание, что выбранные блочные устройства должны принадлежать одному узлу для группы томов с типом 'Local'.
                  properties:
                    matchLabels:
                      description: |
                        Метки для селектора блочных устройств.
                    matchExpressions:
                      description: |
                        Выражения для селектора блочных устройств.
                      items:
                        properties:
                          key:
                            description: |
                              Ключ метки для проверки.
                          operator:
                            description: |
                              Оператор для сравнения значений.
                          values:
                            description: |
                              Массив значений для сравнения. Требуется, если оператор `In` или `NotIn`.
                actualVGNameOnTheNode:
                  description: |
                    Желаемое имя группы томов. Должно быть уникальным для узла, на котором она находится.
                    
                    > Это поле неизменяемое.
                thinPools:
                  description: |
                    Желаемая конфигурация thin pool.
                  items:
                    properties:
                      name:
                        description: |
                          Желаемое имя thin pool.
                          
                          > Это поле неизменяемое.
                      size:
                        description: |
                          Желаемый размер thin pool. Может быть указан как в численном формате, так и в процентах от общего размера группы томов.
                          
                          > При указании размера в процентах thin pool будет автоматически расширен при расширении группы томов.
                      allocationLimit:
                        description: |
                          Предел расширения thin pool.
            status:
              properties:
                thinPoolReady:
                  description: |
                    Отображает количество здоровых и общее количество thin pool.
                configurationApplied:
                  description: |
                    Показывает, была ли последняя конфигурация успешно применена.
                phase:
                  description: |
                    Общее состояние ресурса LVMVolumeGroup.
                conditions:
                  description: |
                    Условия ресурса LVMVolumeGroup.
                  items:
                    properties:
                      type:
                        description: |
                          Тип условия.
                      status:
                        description: |
                          Статус условия.
                      reason:
                        description: |
                          Причина текущего статуса.
                      message:
                        description: |
                          Информация о текущем статусе.
                      lastTransitionTime:
                        description: |
                          Время последнего изменения условия.
                      observedGeneration:
                        description: |
                          Версия ресурса, на которой было применено условие.
                vgUUID:
                  description: |
                    UUID группы томов.
                vgSize:
                  description: |
                    Ёмкость группы томов.
                vgFree:
                  description: |
                    Свободное место в группе томов.
                allocatedSize:
                  description: |
                    Объём пространства, занимаемый в данный момент в группе томов.
                thinPools:
                  description: |
                    Текущее состояние thin pool группы томов.
                    
                    > Может быть пустым, если в группе томов нет ни одного thin pool.
                  items:
                    properties:
                      name:
                        description: |
                          Имя thin pool.
                      actualSize:
                        description: |
                          Ёмкость thin pool.
                      usedSize:
                        description: |
                          Используемый размер thin pool.
                      allocatedSize:
                        description: |
                          Общий размер запрошенных логических томов в thin pool.
                      allocationLimit:
                        description: |
                          Предел расширения thin pool.
                      availableSpace:
                        description: |
                          Свободное место в thin pool.
                      ready:
                        description: |
                          Статус работоспособности thin pool.
                      message:
                        description: |
                          Информация о статусе.
                nodes:
                  description: |
                    Информация об узлах, на которых находится группа томов.
                  items:
                    properties:
                      name:
                        description: |
                          Имя узла.
                      devices:
                        description: |
                          Информация об устройствах, используемых в группе томов на текущем узле.
                        items:
                          properties:
                            path:
                              description: |
                                Путь к устройству на узле.
                            pvSize:
                              description: |
                                Размер физического тома.
                            devSize:
                              description: |
                                Размер блочного устройства.
                            pvUUID:
                              description: |
                                UUID физического тома LVM.
                            blockDevice:
                              description: |
                                Имя соответствующего ресурса блочного устройства.
