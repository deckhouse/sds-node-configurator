# Конфигурация gitleaks для модуля sds-node-configurator
#
# Исключения настроены для файлов из библиотеки util-linux,
# которая устанавливается во время сборки образа agent.

[extend]
useDefault = true

[allowlist]
  # Обоснование исключения:
  #
  # util-linux/include/xxhash.h
  # Заголовочный файл библиотеки xxHash — быстрого некриптографического алгоритма хеширования.
  # Gitleaks ошибочно определяет SIMD-инструкции процессора (_mm512_shuffle_epi32, _mm256_shuffle_epi32)
  # как потенциальные API-ключи из-за их формата именования.
  # Это ложное срабатывание (false positive) — данные строки являются стандартными
  # интринсиками Intel AVX-512/AVX2 для операций перемешивания 32-битных элементов в векторах.
  paths = [
    '''src/sds-node-configurator__agent/util-linux/include/xxhash\.h$''',
  ]
