---
title: " Модуль SDS-Node-Configurator: FAQ"
description: "Распространенные вопросы и ответы на них."
---
{{< alert level="warning" >}}
Работоспособность модуля гарантируется только при использовании стоковых ядер, поставляемых вместе с [поддерживаемыми дистрибутивами](https://deckhouse.ru/documentation/v1/supported_versions.html#linux).

Работоспособность модуля при использовании других ядер или дистрибутивов возможна, но не гарантируется.
{{< /alert >}}
## Почему в кластере не создаются ресурсы `BlockDevice` и `LVMVolumeGroup`?

* В большинстве случаев `BlockDevice`-ресурсы могут не создаваться по причине того, что существующие девайсы не проходят фильтрацию на стороне контроллера. Пожалуйста, убедитесь, что ваши девайсы соответствуют указанным [требованиям](ссылка на требования).

* `LVMVolumeGroup`-ресурсы могут не создаваться по причине отсутствия `BlockDevice`-ресурсов, так как используют их как
источник данных.

* В том случае, если `BlockDevice`-ресурсы существуют, а `LVMVolumeGroup`-ресурсы отсутствуют, пожалуйста, убедитесь, что у существующих `Volume Group` имеется специальный тег `storage.deckhouse.io/enabled=true`.

## Я удалил ресурс `LVMVolumeGroup`, но `Volume Group` осталась? Что делать?

Удаление ресурса `LVMVolumeGroup` не приводит к удалению указанной в нем `Volume Group`. Для этого в ресурс необходимо
добавить специальную аннотацию на запуск процесса удаления: `storage.deckhouse.io/sds-delete-vg: ""`. Контроллер запустит
процесс удаления `Volume Group` и после его завершения удалит связанный ресурс самостоятельно.

> Простое удаление ресурса `LVMVolumeGroup` приведет к созданию нового ресурса со сгенерированным именем по имеющейся `Volume Group`.

## Я добавил аннотацию на удаление, но ресурс `LVMVolumeGroup` продолжает существовать и `Volume Group` на узле осталась. Почему?

Распространенный случай — на `Volume Group`, указанной в ресурсе, имеются `Logical Volume`. Контроллер не удаляет `Logical Volume`, так как эти `volumes` могут иметь различные данные, и пользователь должен самостоятельно очистить их.

Через несколько секунд после удаления `Logical Volume` операция удаления `Volume Group` и связанного с ней ресурса должна быть завершена.

> Время удаления может затянуться в случае, если очередь реконсайлера у контроллера забита иными событиями. Если вы хотите немедленного удаления `Volume Group` и связанного ресурса, можете обновить аннотацию удаления, например, добавив к ее значению любую цифру: `storage.deckhouse.io/sds-delete-vg: ""` -> `storage.deckhouse.io/sds-delete-vg: "1"`.
> В таком случае реконсайл на удаление отработает незамедлительно.

## Я пытаюсь создать `Volume Group`, используя ресурс `LVMVolumeGroup`, но у меня ничего не получается. Почему?

Скорее всего, ваш ресурс не проходит валидацию со стороны контроллера.
С конкретной причиной неработоспособности вы можете ознакомиться в самом ресурсе в поле `Status.Message` либо обратиться
к логам контроллера.

> Как правило, проблема кроется в некорректно указанных ресурсах `BlockDevice`. Пожалуйста, убедитесь, что выбранные
> ресурсы удовлетворяют следующим требованиям:
> - Поле `Consumable` имеет значение `true`.
> - Для `Volume Group` типа `Local` указанные `BlockDevice` принадлежат одному узлу.
> - Для `Volume Group` типа `Shared` указан единственный ресурс `BlockDevice`.
> - Выбранные `BlockDevice` не участвуют в других ресурсах `LVMVolumeGroup` (других `Volume Group`).
> - Указаны актуальные имена ресурсов `BlockDevice`.
>
> С полным списком ожидаемых значений вы можете ознакомиться с помощью [CR-референса](ссылка на реф) `LVMVolumeGroup`-ресурса.

## Что произойдет, если я отключу один из девайсов в `Volume Group`? Соответствующий ресурс `LVMVolumeGroup` удалится?

Ресурс `LVMVolumeGroup` будет существовать до тех пор, пока существует соответствующая `Volume Group`. До тех пор, пока
существует хоть один девайс, `Volume Group` будет существовать, но в «нездоровом» состоянии.
Эти проблемы будут отображены в `Status` ресурса.

После восстановления отключенного девайса `Volume Group` восстановит свою работоспособность и соответствующий ресурс `LVMVolumeGroup` также отобразит актуальное состояние.

## Я хочу, чтобы контроллер перестал следить за `Volume Group`. Как мне это сделать?

Достаточно удалить тег `storage.deckhouse.io/enabled=true` у нужной `Volume Group`. После этого контроллер перестанет отслеживать выбранную `Volume Group` и самостоятельно удалит связанный с ней ресурс `LVMVolumeGroup`.

## Я не вешал тег `storage.deckhouse.io/enabled=true` на `Volume Group`, но он появился. Как это возможно?

Это возможно в случае, если вы создавали `Volume group` через ресурс `LVMVolumeGroup` (в таком случае контроллер автоматически вешает данный тег на созданную `Volume Group`) либо на данной `Volume Group` был тег модуля `Linstor` — `linstor-*`.
Модуль `sds-node-configurator` заменяет часть функционала контроллера `linstor-pools-importer` из встроенного модуля `Linstor`.
Поэтому при переходе с встроенного модуля `Linstor` на модули `sds-node-configurator` и `sds-drbd` автоматически происходит изменение тегов `linstor-*` на тег `storage.deckhouse.io/enabled=true` в `Volume Group`. Таким образом, управление этими `Volume Group` передается модулю `sds-node-configurator`.

> Контроллер единоразово совершает операцию перетегирования по всем существующим `Volume Group` в момент своего запуска.
